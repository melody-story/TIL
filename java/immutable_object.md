## 불변객체

### 불변 객체(immutable object) 란?

- 객체 지향 프로그래밍에 있어서 불변객체(immutable object)는 생성 후 그 `상태`를 바꿀 수 없는 객체를 말한다.
- 그렇기 때문에 `한 번 생성이 되면 신뢰`할 수 있는 객체가 된다.
- 가장 대표적인 불변객체로는 String, Integer, Boolean, BigDecimal ...이 있다. 아래의 예제는 String을 예로 들었다.

```java
String str = "a"; //(1) 
str = "b"; //(2) 
str = "Immutable"; //(3)
```

String은 참조변수이기 때문에 메모리 상 heap영역에 저장이 된다. 위의 코드를 실행하면 메모리상 객체 생성과 참조가 어떻게 일어나는지 살펴보자.

(1)을 실행하면 heap영역에 str이 참조하고 있는 "a"라는 객체가 생성된다.
(2)를 실행하면 "a"라는 객체가 "b"라는 값으로 변하는 것이 아니라 "b"라는 새로운 객체를 만든다. 그리고 (1)에서 생성되었던 str은 "b"객체를 바라본다.
(3)을 실행하면 "Immutable"이라는 새로운 객체를 만든다. 그리고 (1)에서 생성되었던 str은 "Immutable"객체를 바라본다.

위의 코드를 (3)까지 실행하게 되면 (1),(2)에서 생성했던 "a","b"라는 객체는 아무것도 참조하고 있지 않는 객체가 되어 GC의 대상이 된다.

위의 예제에서 볼 수 있듯이 String은 불변객체라 "a"에서 "b" 로 변하는 것이 아닌 새로운 객체를 생성한다.


## 왜 불변 객체를 사용하는가?

1. 불변객체는 근본적으로 쓰레드에 안전하여 동기화를 시킬 필요가 없다. 
2. 한 번 생성된 불변객체에 대해서는 다른 어떤 쓰레드도 다른 쓰레드에 영향을 줄 수 없다. 
3. 그렇기 때문에 불변객체는 `안심하고 공유`가 가능하다.
3. 불변객체는 그 자체로 실패 원자성을 제공한다. 
4. `실패 원자성`이란 `호출된 메소드가 실패하더라도 해당 객체는 메소드 호출 전 상태가 유지`되어야 한다는 것이다. 
5. 불변객체는 `상태가 절대로 변하지 않기 때문에` 이를 제공한다.

## 불변 객체를 어떻게 만드는가?

1. setter를 사용하지 않는다. (객체의 상태를 변경하는 메소드 미제공)
2. 변수를 `private`으로 선언한다.
3. 변수를 `final`로 선언한다.
